server:
  port: 80
spring:
  application:
    name: dcp-admin
  # 默认使用dev环境（本地开发）
  profiles:
    active: dev
  mail:
    host: smtp.qq.com
    port: 465
    username: 2497822530@qq.com
    password: xkzyzwwiqzzhdjgj
    protocol: smtp
    default-encoding: UTF-8
    properties:
      mail:
        smtp:
          auth: true
          ssl:
            enable: true
            required: true
          socketFactory:
            class: javax.net.ssl.SSLSocketFactory
            port: 465
          timeout: 5000
          connectiontimeout: 5000
          writetimeout: 5000

  # 数据源配置（已移至环境特定配置文件：application-dev.yml 和 application-prod.yml）

  # Redis配置
  data:
    redis:
      host: localhost
      port: 6379
      database: 0
      timeout: 5000ms
      lettuce:
        pool:
          max-active: 8
          max-idle: 8
          min-idle: 0
          max-wait: -1ms

  # JSON配置
  jackson:
    date-format: yyyy-MM-dd HH:mm:ss
    time-zone: GMT+8
    # 使用下划线命名策略
    property-naming-strategy: SNAKE_CASE
    serialization:
      write-dates-as-timestamps: false
      write-null-map-values: false
    default-property-inclusion: non_null

  # 文件上传配置
  servlet:
    multipart:
      enabled: true
      max-file-size: 50MB
      max-request-size: 100MB

# MyBatis Plus配置
mybatis-plus:
  mapper-locations: classpath*:/mapper/**/*.xml
  type-aliases-package: com.qianjisan.entity,qianjisan.entity,com.qianjisan.system.entity
  configuration:
    map-underscore-to-camel-case: true
    cache-enabled: false
    call-setters-on-nulls: true
    jdbc-type-for-null: null
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
  global-config:
    db-config:
      id-type: auto
      logic-delete-field: isDeleted
      logic-delete-value: 1
      logic-not-delete-value: 0

# Knife4j配置
knife4j:
  enable: true
  setting:
    language: zh_cn
  openapi:
    title: DCP项目管理系统API文档
    description: DCP Project Management System API Documentation
    version: v1.0.0
    contact:
      name: DCP Team
      email: support@dcp.com
    group:
      default:
        group-name: 默认分组
        api-rule: package
        api-rule-resources:
          - com.qianjisan.controller
          - com.qianjisan.system.controller
          - qianjisan.controller

# 日志配置（通过logback-spring.xml配置彩色日志）
# logging配置已移至logback-spring.xml
# 使用彩色日志输出，支持dev和prod环境配置

# JWT配置
jwt:
  secret: dcp-secret-key-2024-springboot3-jdk21-mybatis-plus-redis
  expiration: 604800 # 7天，单位：秒
  header: Authorization
  prefix: "Bearer "

# 应用自定义配置
dcp:
  # 文件上传路径
  upload-path: /Users/10284941/IdeaProjects/qianjisan/pmp/dcp-admin/uploads
  # 跨域配置
  cors:
    allowed-origins:
      - http://localhost:5173
      - http://localhost:8080
    allowed-methods:
      - GET
      - POST
      - PUT
      - DELETE
      - OPTIONS
    allowed-headers:
      - "*"
    allow-credentials: true
    max-age: 3600

  # 限流配置
  rate-limit:
    # 是否启用限流功能
    enabled: true
    # 默认限流配置
    default:
      # 时间窗口（秒）
      time: 60
      # 最大访问次数
      count: 100
      # 提示消息
      message: 访问过于频繁，请稍后再试
    # IP限流配置
    ip:
      time: 60
      count: 30
      message: 您的访问过于频繁，请稍后再试
    # 用户限流配置
    user:
      time: 60
      count: 50
      message: 您的操作过于频繁，请稍后再试
    # 特殊接口限流配置
    special:
      # 登录接口
      login:
        time: 300
        count: 5
        message: 登录尝试次数过多，请5分钟后再试
      # 发送验证码
      send-code:
        time: 86400
        count: 10
        message: 今日验证码发送次数已达上限
      # 注册接口
      register:
        time: 3600
        count: 3
        message: 注册尝试次数过多，请1小时后再试
